<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>xml-qstat: web-based monitoring for gridengine clusters</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="xml-qstat web-based monitoring for gridengine clusters" />
<meta name="language" content="en" />

<link href="css/layout_2col_left_13.css" rel="stylesheet" type="text/css"/>
<!--[if lte IE 7]>
<link href="css/patches/patch_2col_left_13.css" rel="stylesheet" type="text/css"/>
<![endif]-->
<link href="css/screen/images/xmlqstat.png" rel="shortcut icon" type="image/png"/>

</head>
<body>
<div class="page_margins">
  <div class="page">
    <div id="header">
      <div class="subcolumns">
        <div class="c75l">
          <img src="css/screen/images/xmlqstat-logo.png"
              alt="xml-qstat logo" />
        </div>
        <div class="c25r">
          <a href="http://github.com/olesenm/xml-qstat">
            <img style="position: absolute; top: 0; right: 0; border: 0;"
            src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
            alt="Fork me on GitHub" />
          </a>
        </div>
      </div>

      Web-based status monitoring of
      <a href="http://en.wikipedia.org/wiki/Grid_Engine">Grid Engine</a> clusters,
      provided by the <a href="http://www.bioteam.net">BioTeam</a>

    </div>
    <!-- begin: main navigation #nav -->
    <div id="nav">
      <!-- skiplink anchor: navigation -->
      <a id="navigation" name="navigation"></a>
      <div class="hlist">
        <ul>
          <li><a href="index.html">About</a></li>
          <li><a href="history.html">History</a></li>
          <li><a href="screenshots.html">Screenshots</a></li>
          <li><a href="demo.html">Demo</a></li>
          <li><a href="requirements.html">Requirements</a></li>
          <li><a href="license.html">License</a></li>
          <li><a href="download.html">Download</a></li>
          <li id="current"><a href="install.html">Install</a></li>
          <li><a href="support.html">Support</a></li>
          <li><a href="thanks.html">Acknowledgments</a></li>
        </ul>
      </div>
    </div>
    <!-- end: main navigation -->
    <!-- begin: main content area #main -->
    <div id="main">
      <!-- begin: #col1 static column -->
      <div id="col1">
        <div id="col1_content" class="clearfix">

<h6 class="vlist">Installation</h6>
<ul class="vlist">
  <li><a href="install.html">General</a></li>
  <li class="active"><strong>Cocoon</strong></li>
  <li><a href="httpi.html">HTTPi</a></li>
</ul>

<h6 class="vlist">get latest source code</h6>
<ul class="vlist">
  <li><a href="http://github.com/bioteam/xml-qstat">bioteam/xml-qstat</a></li>
  <li><a href="http://github.com/olesenm/xml-qstat">olesenm/xml-qstat</a></li>
</ul>
<h6 class="vlist">related projects</h6>
<ul class="vlist">
  <li><a href="http://olesenm.github.com/flex-grid">flex-grid</a>
</ul>
<h6 class="vlist">quick links</h6>
<ul class="vlist">
  <li><a href="http://gridengine.sunsource.net">Grid Engine project</a></li>
  <li><a href="http://wiki.gridengine.info/wiki">wiki.gridengine.info/wiki</a></li>
</ul>


        </div>
      </div>
      <!-- end: #col1 -->
      <!-- begin: #col3 - first float column -->
      <div id="col3">
        <div id="col3_content" class="clearfix"> <a id="content" name="content"></a>
          <!-- skiplink anchor: Content -->


<h3>Preamble</h3>
<p>
  <em><strong>
  Apache Cocoon 2.2 (any version) is not supported at all as Cocoon 2.2
  represents a radical change from 2.1
  </strong></em>.
</p>
<p>
  Within the standard <b>cocoon</b> installation directory,
  the only file touched is a customized "mount-table.xml" configuration file
  that informs the application server that the URI-prefix of <b>/xmlqstat/</b>
  should be handled by the <b>xmlqstat/</b> folder. If you are upgrading
  from an older version of cocoon, or if you have relocated the
  <b>xml-qstat</b> directory, you will need to adjust the "mount-table.xml"
  accordingly.
</p>
<p>
  It may help to be familiar with the contents of the <b>sitemap.xmap</b>
  that is distributed with <b>xml-qstat</b> since this is the single Cocoon
  configuration file that controls which XSLT transformations occur when a
  particular URL path is seen.
</p>

<h3>Cocoon Installation (for server-side XSLT)</h3>
<ol>
<li>
  Make sure you have Java available and that the $JAVA_HOME environment variable is set.
</li>
<li>
  Download <a href="http://cocoon.apache.org/2.1/">Apache Cocoon</a>
  version 2.1.x, preferably the latest stable version 2.1.11.
  Simply unpacking the distribution into the <b>cocoon/</b> folder and
  running the "build.sh" script should work fine. The build may take several
  minutes and when it completes you will have a script called "cocoon.sh"
  that can be run. In its default form (with 2.1.8 or later) simply running
  "./cocoon.sh" as a non-privledged user will cause Cocoon to start up its
  own internal application server that binds to all available network
  interfaces and listens for incoming connections at port number 8888. To
  test, simply point your web browser at the http://&lt;host&gt;:8888/xmlqstat/
  -- if it works you will see a Cocoon welcome screen. Firewall users should
  make sure that TCP connections to port 8888 are allowed.
</li>
<li>Create the <b>mount-table.xml</b> configuration file in the cocoon directory (details are below).</li>
<li>Build xml-qstat.jar and install it into the proper Cocoon lib/ direcory (details are below)</li>
<li>The web interface should be ready for testing. Point a web browser at
the URL http://&lt;host&gt;:8888/xmlqstat/</li>
</ol>


<h3>Installation Details: Apache Cocoon</h3>
<p>
  With <tt>$JAVA_HOME</tt> set, the application should build itself via the
  &quot;build.sh&quot; script. After it is built the &quot;cocoon.sh&quot;
  script will launch the application server. Successful operation can be
  verified by pointing a web browser at http://&lt;host&gt;:8888/ and seeing
  the &quot;Welcome to Apache Cocoon&quot; message.
</p>
<p>
  When starting cocoon.sh to service the xml-qstat web application, the
  following conditions must be met:
</p>
<p>
- The xml-qstat <b>scripts/qstat.sh</b> and <b>scripts/qhost.sh</b>
  must be in the $PATH before starting the cocoon server so that the
  server can find and execute them when needed
</p>
<p>
  - The SGE settings and environment variables must be present (source the
  Grid Engine <b>settings.sh</b> or <b>settings.csh</b> script before starting
  the cocoon server)
</p>
<p>
  - These path and environment settings can be adjusted manually before
  starting the server or can be edited into the <b>cocoon.sh</b> script.
</p>

<h3>Advanced Installation: Cocoon behind Apache Proxies</h3>
<p>
  Many Unix servers already have an Apache webserver running on the system.
  If you have administrative access to this server, you can proxy the Cocoon
  application server behind Apache. The primary benefit is removing the
  browser requirement to connect to TCP port 8888. The URL changes from
  http://&lt;host&gt;:8888/xmlqstat/ to http://&lt;host&gt;/xmlqstat/. This
  also allows firewall administrators to seal port 8888 closed against all
  connections not coming from the Apache server. The Apache configuration
  directives to do this would be:
</p>

<pre>
  ## Let Apache proxy connections to cocoon on port 8888 forward and reverse...
  ProxyPass /xmlqstat http://127.0.0.1:8888/xmlqstat
  ProxyPassReverse /xmlqstat http://127.0.0.1:8888/xmlqstat
</pre>

<h3>Building xml-qstat.jar and installing it into Cocoon</h3>
<p>
  When operating with live (non-cached) data, the web application needs a
  method of calling SGE programs such as 'qstat' in order to fetch XML data.
  This is done with a Java-based helper class that must be built into a .jar
  file and installed in a place where the Cocoon application server can
  access it. At the top level of the xml-qstat checkout will be a shell
  script called &quot;make-xmlqstat-jar.sh&quot;.
</p>
<p>
  To build and install the Jar file:
</p>
<ol>
<li>Edit make-xmlqstat-jar.sh to set the cocoonBase directory</li>
<li>Make sure Java and 'javac' are in your path</li>
<li>Run the script</li>
<li>
  Copy the resulting build/xml-qstat.jar file into the location specified by
  the build script output
</li>
<li>Stop and restart Cocoon (if necessary)</li>
</ol>

<h3>Creating mount-table.xml</h3>
<p>
  Within the <b>cocoon/</b> directory it is possible to create a file called
  <b>mount-table.xml</b>.
  The purpose of this file is to allow webapp folders to exist elsewhere on
  the system rather than forcing them to be installed inside the <b>cocoon/</b>
  folder itself. If your file layout matches the example:
</p>
<pre>
$ ls -l /opt/xml-qstat/
drwxr-xr-x    cocoon-2.1.11/
drwxr-xr-x    httpi-1.6.1/
drwxr-xr-x    xml-qstat/
</pre>
<p>
  Then you would simply create a file called <b>cocoon-2.1.11/mount-table.xml</b>
  with contents that looked like this
  (yes the relative uri-prefix &quot;<em>../../../xml-qstat/xmlqstat/</em>&quot;
  path is correct for the directory layout shown above) :
</p>
<pre>
  &lt;mount-table&gt;
    &lt;!-- Map the browser URI "/xmlqstat" to our webapp folder --&gt;
    &lt;mount uri-prefix="xmlqstat/" src="../../../xml-qstat/xmlqstat/"/&gt;
  &lt;/mount-table&gt;
</pre>
<p>
  After creating this file, it will be necessary to stop and restart Cocoon
  if it was running previously. Once cocoon is restarted, the application
  server will know how to find the xmlqstat/ application files when web
  clients request the URI-prefix of "/xmlqstat". Remember the other
  prerequisites including the SGE environment variables and the $PATH
  adjustment so that <b>xml-qstat/scripts/qstat.sh</b> can be found.
</p>


        </div>
        <div id="ie_clearing">&nbsp;</div>
        <!-- End: IE Column Clearing -->
      </div>
      <!-- end: #col3 -->
    </div>
    <!-- end: #main -->
    <!-- begin: #footer -->
    <div id="footer">
        Layout based on <a href="http://www.yaml.de/en/">YAML</a> from Dirk Jesse
    </div>
    <!-- end: #footer -->
  </div>
</div>
</body>
</html>
