<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>xml-qstat: web-based monitoring for gridengine clusters</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="xml-qstat web-based monitoring for gridengine clusters" />
<meta name="language" content="en" />

<link href="/css/layout_2col_left_13.css" rel="stylesheet" type="text/css"/>
<!--[if lte IE 7]>
<link href="/css/patches/patch_2col_left_13.css" rel="stylesheet" type="text/css"/>
<![endif]-->
<link href="/css/screen/images/xmlqstat.png" rel="shortcut icon" type="image/png"/>

</head>
<body>
<div class="page_margins">
  <div class="page">
    <div id="header">
      <div class="subcolumns">
        <div class="c75l">
          <img src="/css/screen/images/xmlqstat-logo.png"
              alt="xml-qstat logo" />
        </div>
        <div class="c25r">
          <a href="http://github.com/olesenm/xml-qstat">
            <img style="position: absolute; top: 0; right: 0; border: 0;"
            src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
            alt="Fork me on GitHub" />
          </a>
        </div>
      </div>

      Web-based status monitoring of
      <a href="http://en.wikipedia.org/wiki/Grid_Engine">Grid Engine</a> clusters,
      provided by the <a href="http://www.bioteam.net">BioTeam</a>

    </div>
    <!-- begin: main navigation #nav -->
    <div id="nav">
      <!-- skiplink anchor: navigation -->
      <a id="navigation" name="navigation"></a>
      <div class="hlist">
        <ul>
          <li><a href="index.html">About</a></li>
          <li><a href="history.html">History</a></li>
          <li><a href="screenshots.html">Screenshots</a></li>
          <li><a href="demo.html">Demo</a></li>
          <li><a href="requirements.html">Requirements</a></li>
          <li><a href="license.html">License</a></li>
          <li><a href="download.html">Download</a></li>
          <li id="current"><a href="#">Install</a></li>
          <li><a href="support.html">Support</a></li>
          <li><a href="thanks.html">Acknowledgments</a></li>
        </ul>
      </div>
    </div>
    <!-- end: main navigation -->
    <!-- begin: main content area #main -->
    <div id="main">
      <!-- begin: #col1 static column -->
      <div id="col1">
        <div id="col1_content" class="clearfix">

<h6 class="vlist">Installation</h6>
<ul class="vlist">
  <li class="active"><strong>General</strong></li>
  <li><a href="cocoon.html">Cocoon</a></li>
  <li><a href="httpi.html">HTTPi</a></li>
</ul>

<h6 class="vlist">get latest source code</h6>
<ul class="vlist">
  <li><a href="http://github.com/bioteam/xml-qstat">bioteam/xml-qstat</a></li>
  <li><a href="http://github.com/olesenm/xml-qstat">olesenm/xml-qstat</a></li>
</ul>
<h6 class="vlist">related projects</h6>
<ul class="vlist">
  <li><a href="http://olesenm.github.com/flex-grid">flex-grid</a>
</ul>
<h6 class="vlist">quick links</h6>
<ul class="vlist">
  <li><a href="http://gridengine.sunsource.net">Grid Engine project</a></li>
  <li><a href="http://wiki.gridengine.info/wiki">wiki.gridengine.info/wiki</a></li>
</ul>


        </div>
      </div>
      <!-- end: #col1 -->
      <!-- begin: #col3 - first float column -->
      <div id="col3">
        <div id="col3_content" class="clearfix"> <a id="content" name="content"></a>
          <!-- skiplink anchor: Content -->


<h3>Installation</h3>
<p>
  No officially packaged release exists yet. The instructions below are
  temporary instructions for advanced users (ie, should not pose problems
  for a typical cluster admin), people who want to see what the new github
  hosted code can do, as well as for people who are interested in becoming
  developers or contributors.
</p>

<h3>Housekeeping</h3>
<p>
  The choice of installation directory is up to you, we recommend organizing
  the independent components parallel to each other in the following manner:
</p>
<pre>
$ ls -l /opt/xml-qstat/
drwxr-xr-x    cocoon-2.1.11/   # for server-side xslt
drwxr-xr-x    httpi-1.6.1/     # for client-side xslt
drwxr-xr-x    xml-qstat/       # our application
</pre>
<p>
  The <b>cocoon/</b> directory is a standard Apache Cocoon installation.
  It is only required when <em>server-side</em> XSLT transformations are
  desired.
</p>
<p>
  The <b>httpi/</b> directory contains a tiny, fast and secure pure-Perl
  webserver known as <a href="http://www.floodgap.com/httpi/">HTTPi</a>.
  It is only required when <em>client-side</em> XSLT transformations are
  desired or when other customized data sources (XML or otherwise)
  may be desired.
</p>

<h3>Package Overview</h3>
<p>
  Inside <b>xml-qstat</b>/
</p>
<pre>
$ ls -l xml-qstat/
drwxr-xr-x    httpi-modules/
drwxr-xr-x    icons/
drwxr-xr-x    init-scripts/
drwxr-xr-x    java/
-rw-r--r--    make-xmlqstat-jar.sh
drwxr-xr-x    scripts/
drwxr-xr-x    xmlqstat/
</pre>
<p>
  The <b>httpi-modules/</b> folder contains customized modules
  for HTTPi. Only needed for the HTTPi client-side installation.
</p>
<p>
  The <b>icons/</b> folder contains various icons that are not currently
  used in the rendered views. They are split off to permit a more compact
  final installation if required.
</p>
<p>
  The <b>init-scripts/</b> folder contains helper scripts for automatically
  running or daemonizing programs such as the application servers (cocoon
  and/or HTTPi) and the XML caching scripts.
</p>
<p>
  The <b>java/</b> folder contains the CommandGenerator used in the
  Cocoon server-side installation.
</p>
<p>
  The <b>make-xmlqstat-jar.sh</b> script for compiling
  the CommandGenerator used in the Cocoon server-side installation.
</p>
<p>
  The <b>scripts/</b> folder currently contains 2 perl scripts, a CGI script
  called 'jobinfo' and a &quot;qstat.sh&quot; shell script that the
  application can use to directly query the Grid Engine qmaster. The
  "sge-xml-cacher.pl" script is a Perl daemon script that runs constantly
  and periodically refreshes the cached Grid Engine XML status data. This
  cached data is what the XSLT uses to generate various views and interfaces.
  The default setting for this daemon is to refresh Grid Data every 30
  seconds (this value is user configurable). The Perl daemon is used so that
  the webserver does not call "qstat -f -xml" every time a user hits the web page.
  The caching mechanism greatly reduces the load on the SGE qmaster and the
  webserver. The second Perl script,
  "<b>create-threshold-config.pl</b>" is <em>optional</em> and is a helper
  script that can query Grid Engine to learn the configured load alarm
  thresholds for each queue. Since Grid Engine only reports current load
  values (and not the configured alarm thresholds) this helper script can
  create a secondary configuration file that is used in the XSLT to generate
  customized graphical "load ratio" reports within the web interface.
  The <b>'jobinfo'</b> script can be used as a CGI under Apache or HTTPi if
  an external URL-based source for SGE XML status data is desired.
</p>

<p>
  The <b>xmlqstat/</b> folder is where this application lives.
  It is organized into the following subfolders:
</p>
<pre>
$ ls -l xmlqstat/
drwxr-xr-x   config/
drwxr-xr-x   css/
drwxr-xr-x   javascript/
-rw-r--r--   sitemap.xmap
drwxr-xr-x   xml/
drwxr-xr-x   xsl/
</pre>
<p>
  The <b>config/</b> folder contains XML configuration files for the
  xml-qstat application and the logo image.
  The <b>css/</b> folder contains CSS stylesheets used for separation
  of content from presentation.
  The <b>css/screen/</b> subfolder contains icons and graphic elements.
  The <b>javascript/</b> folder contains javascript used for presentation
  and display preference formatting.
  The <b>sitemap.xmap</b> is a Cocoon configuration file that tells the
  application server how to handle, route and process various transformation
  requests.
  The <b>xml/</b> folder contains the raw XML source for documentation
  and help files.
  The <b>xsl/</b> folder contains the XSLT stylesheets that guide the
  transformation of Grid Engine XML into various output forms.
</p>
<p>
  Generally speaking, the user will only need to edit files in the
  <strong>config/</strong> directory.
  In very rare cases the user may need to edit <b>sitemap.xmap</b> to make
  configuration changes for Cocoon.
</p>

<h3>Installation Overview</h3>
<ol>
<li>Grid Engine 6.2 should be installed and functioning.
    Earlier versions of Grid Engine produce different XML output and may not be supported well.
    </li>
<li>Make sure you have Perl available</li>
<li>Create a folder to hold the misc. components (something like xml-qstat/)</li>
<li>
  Download and build Apache Cocoon or HTTPi,
  depending on the type of webserver you wish.
</li>
<li>
  Checkout or download xml-qstat from github.com
</li>
<li>
  Edit the <b>xmlqstat/config/config.xml</b> file to set local configuration
  parameters (details are below)
</li>
<li>
  Edit the <b>scripts/sge-xml-cacher.pl</b> script to configure the full
  Unix file path to where cached SGE status data will be stored.
  The data should typically be stored within the <b>xmlqstat/cache/</b>
  folder as "qstatf.xml". For a multi-cluster view,
  the file should be stored as <b>xmlqstat/cache/qstatf~NAME.xml</b>
  or as <b>xmlqstat/cache-NAME/qstatf.xml</b>, where <em>NAME</em> is the name
  given to the cluster. This convention should be followed, otherwise severe
  editing of the sitemap.xmap and/or the custom HTTPi will be required.
</li>
<li>
  If you are running the qlicserver on your system, you can instruct it to
  cache its data for reuse here. Otherwise, start caching grid data! If your
  SGE environment has been set up (you can run 'qstat' via the command line)
  then starting the perl caching
  daemon should be as simple as entering the <b>scripts/</b> folder and
  issuing the command "./xmlqstat-cacher.pl -d". To stop the daemon, issue
  the command "./xmlqstat-cacher.pl -k". To verify that the daemon is
  working, check the process table to see if it exists and then monitor the
  timestamps on the cache file. In its default setting, XML data should be
  updated every 30 seconds.
</li>
<li>
  The web interface should be ready for testing. Point a web browser at the
  URL http://&lt;host&gt;:8080/xmlqstat/ or
  http://&lt;host&gt;:8888/xmlqstat/, the host and port number depending on
  your configuration.
</li>
</ol>


<h3>Customizing the config/</h3>
<p>
  Within the <b>xmlqstat/config/</b> directory there is a file called
  <b>config.xml</b> that needs to be edited to reflect the local site
  installation. The file is well documented internally so it should be a
  simple process to edit.
  The file <b>xmlqstat/config/logo.png</b> is not tracked in git and can be
  used to define a logo to be displayed at the top of each page.
</p>

<h3>Using Cached Grid Engine XML</h3>
<p>
  To reduce load on the qmaster and avoid calling 'qstat' each time a page
  is accessed, cached SGE data can be used. A script in the <b>scripts/</b>
  folder called &quot;xmlqstat-cacher.pl&quot; can perform this function.
</p>
<p>
  The cache location is defined by how the cluster is named in 
  <b>config/config.xml</b>.
  Create a directory with &quot;<b>cache-</b>&quot; 
  prepended to the cluster name
  within the <b>xmlqstat</b> folder (at the same level as where the sitemap.xmap
  file exists). The application will automatically detect the presence of
  the cache directory if this naming and location convention is followed.
  <ul>
  <li>
    The xmlqstat-cacher.pl program will create the needed cache files
    &quot;qstat.xml&quot;, &quot;qstatf.xml&quot; and &quot;qhost.xml&quot;.
  </li>
  <li>
    The qlicserver program can be instructed to create the needed cache files
    &quot;qhost.xml&quot;, &quot;qstat.xml&quot; and &quot;qlicserver.xml&quot;.
  </li>
  </ul>
</p>


        </div>
        <div id="ie_clearing">&nbsp;</div>
        <!-- End: IE Column Clearing -->
      </div>
      <!-- end: #col3 -->
    </div>
    <!-- end: #main -->
    <!-- begin: #footer -->
    <div id="footer">
        Layout based on <a href="http://www.yaml.de/en/">YAML</a> from Dirk Jesse
    </div>
    <!-- end: #footer -->
  </div>
</div>
</body>
</html>
